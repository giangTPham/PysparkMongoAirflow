Spark Executor Command: "/home/gitpod/.sdkman/candidates/java/current/bin/java" "-cp" "/workspace/PysparkMongoAirflow/spark-3.1.1-bin-hadoop2.7/conf/:/workspace/PysparkMongoAirflow/spark-3.1.1-bin-hadoop2.7/jars/*" "-Xmx1024M" "-Dspark.driver.port=37711" "org.apache.spark.executor.CoarseGrainedExecutorBackend" "--driver-url" "spark://CoarseGrainedScheduler@10.0.2.100:37711" "--executor-id" "0" "--hostname" "10.0.2.100" "--cores" "1" "--app-id" "app-20220302074713-0005" "--worker-url" "spark://Worker@10.0.2.100:36917"
========================================

Picked up JAVA_TOOL_OPTIONS:  -Xmx3435m
Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
22/03/02 07:47:14 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 30741@giangtpham-pysparkmongoa-8e4ves7r5or
22/03/02 07:47:14 INFO SignalUtils: Registering signal handler for TERM
22/03/02 07:47:14 INFO SignalUtils: Registering signal handler for HUP
22/03/02 07:47:14 INFO SignalUtils: Registering signal handler for INT
22/03/02 07:47:14 WARN Utils: Your hostname, giangtpham-pysparkmongoa-8e4ves7r5or resolves to a loopback address: 127.0.0.1; using 10.0.2.100 instead (on interface tap0)
22/03/02 07:47:14 WARN Utils: Set SPARK_LOCAL_IP if you need to bind to another address
WARNING: An illegal reflective access operation has occurred
WARNING: Illegal reflective access by org.apache.spark.unsafe.Platform (file:/workspace/PysparkMongoAirflow/spark-3.1.1-bin-hadoop2.7/jars/spark-unsafe_2.12-3.1.1.jar) to constructor java.nio.DirectByteBuffer(long,int)
WARNING: Please consider reporting this to the maintainers of org.apache.spark.unsafe.Platform
WARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations
WARNING: All illegal access operations will be denied in a future release
22/03/02 07:47:15 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
22/03/02 07:47:15 INFO SecurityManager: Changing view acls to: gitpod
22/03/02 07:47:15 INFO SecurityManager: Changing modify acls to: gitpod
22/03/02 07:47:15 INFO SecurityManager: Changing view acls groups to: 
22/03/02 07:47:15 INFO SecurityManager: Changing modify acls groups to: 
22/03/02 07:47:15 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(gitpod); groups with view permissions: Set(); users  with modify permissions: Set(gitpod); groups with modify permissions: Set()
22/03/02 07:47:15 INFO TransportClientFactory: Successfully created connection to /10.0.2.100:37711 after 95 ms (0 ms spent in bootstraps)
22/03/02 07:47:15 INFO SecurityManager: Changing view acls to: gitpod
22/03/02 07:47:15 INFO SecurityManager: Changing modify acls to: gitpod
22/03/02 07:47:15 INFO SecurityManager: Changing view acls groups to: 
22/03/02 07:47:15 INFO SecurityManager: Changing modify acls groups to: 
22/03/02 07:47:15 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(gitpod); groups with view permissions: Set(); users  with modify permissions: Set(gitpod); groups with modify permissions: Set()
22/03/02 07:47:15 INFO TransportClientFactory: Successfully created connection to /10.0.2.100:37711 after 2 ms (0 ms spent in bootstraps)
22/03/02 07:47:15 INFO DiskBlockManager: Created local directory at /tmp/spark-4b8a5c4f-fd59-4e7b-b712-4d7efa021ada/executor-4875d582-3b14-40d8-aecf-acc666495cfe/blockmgr-a78a8fbc-1a51-458d-88d0-dc2993bc7586
22/03/02 07:47:16 INFO MemoryStore: MemoryStore started with capacity 434.4 MiB
22/03/02 07:47:16 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@10.0.2.100:37711
22/03/02 07:47:16 INFO WorkerWatcher: Connecting to worker spark://Worker@10.0.2.100:36917
22/03/02 07:47:16 INFO TransportClientFactory: Successfully created connection to /10.0.2.100:36917 after 2 ms (0 ms spent in bootstraps)
22/03/02 07:47:16 INFO ResourceUtils: ==============================================================
22/03/02 07:47:16 INFO ResourceUtils: No custom resources configured for spark.executor.
22/03/02 07:47:16 INFO ResourceUtils: ==============================================================
22/03/02 07:47:16 INFO WorkerWatcher: Successfully connected to spark://Worker@10.0.2.100:36917
22/03/02 07:47:16 INFO CoarseGrainedExecutorBackend: Successfully registered with driver
22/03/02 07:47:16 INFO Executor: Starting executor ID 0 on host 10.0.2.100
22/03/02 07:47:16 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 40075.
22/03/02 07:47:16 INFO NettyBlockTransferService: Server created on 10.0.2.100:40075
22/03/02 07:47:16 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
22/03/02 07:47:16 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(0, 10.0.2.100, 40075, None)
22/03/02 07:47:16 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(0, 10.0.2.100, 40075, None)
22/03/02 07:47:16 INFO BlockManager: Initialized BlockManager: BlockManagerId(0, 10.0.2.100, 40075, None)
22/03/02 07:47:18 INFO CoarseGrainedExecutorBackend: Got assigned task 0
22/03/02 07:47:18 INFO Executor: Running task 0.0 in stage 0.0 (TID 0)
22/03/02 07:47:18 INFO TorrentBroadcast: Started reading broadcast variable 1 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:18 INFO TransportClientFactory: Successfully created connection to /10.0.2.100:38343 after 3 ms (0 ms spent in bootstraps)
22/03/02 07:47:18 INFO MemoryStore: Block broadcast_1_piece0 stored as bytes in memory (estimated size 5.4 KiB, free 434.4 MiB)
22/03/02 07:47:18 INFO TorrentBroadcast: Reading broadcast variable 1 took 159 ms
22/03/02 07:47:18 INFO MemoryStore: Block broadcast_1 stored as values in memory (estimated size 10.8 KiB, free 434.4 MiB)
22/03/02 07:47:19 INFO CodeGenerator: Code generated in 208.32764 ms
22/03/02 07:47:19 INFO FileScanRDD: Reading File path: file:///workspace/PysparkMongoAirflow/Final_Project/data/source/promotions/2021-11-01/part-00000-802e6ae2-b27d-463b-a5c0-5b2d91ad831f-c000.csv, range: 0-51809, partition values: [empty row]
22/03/02 07:47:19 INFO CodeGenerator: Code generated in 9.934221 ms
22/03/02 07:47:19 INFO TorrentBroadcast: Started reading broadcast variable 0 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:19 INFO MemoryStore: Block broadcast_0_piece0 stored as bytes in memory (estimated size 24.1 KiB, free 434.4 MiB)
22/03/02 07:47:19 INFO TorrentBroadcast: Reading broadcast variable 0 took 14 ms
22/03/02 07:47:19 INFO MemoryStore: Block broadcast_0 stored as values in memory (estimated size 201.2 KiB, free 434.2 MiB)
22/03/02 07:47:19 INFO Executor: Finished task 0.0 in stage 0.0 (TID 0). 1607 bytes result sent to driver
22/03/02 07:47:20 INFO CoarseGrainedExecutorBackend: Got assigned task 1
22/03/02 07:47:20 INFO Executor: Running task 0.0 in stage 1.0 (TID 1)
22/03/02 07:47:20 INFO TorrentBroadcast: Started reading broadcast variable 3 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:20 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 7.9 KiB, free 434.2 MiB)
22/03/02 07:47:20 INFO TorrentBroadcast: Reading broadcast variable 3 took 12 ms
22/03/02 07:47:20 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 15.5 KiB, free 434.1 MiB)
22/03/02 07:47:21 INFO CodeGenerator: Code generated in 9.712429 ms
22/03/02 07:47:21 INFO FileScanRDD: Reading File path: file:///workspace/PysparkMongoAirflow/Final_Project/data/source/promotions/2021-11-01/part-00000-802e6ae2-b27d-463b-a5c0-5b2d91ad831f-c000.csv, range: 0-51809, partition values: [empty row]
22/03/02 07:47:21 INFO TorrentBroadcast: Started reading broadcast variable 2 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_2_piece0 stored as bytes in memory (estimated size 24.1 KiB, free 434.1 MiB)
22/03/02 07:47:21 INFO TorrentBroadcast: Reading broadcast variable 2 took 11 ms
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_2 stored as values in memory (estimated size 201.2 KiB, free 433.9 MiB)
22/03/02 07:47:21 INFO Executor: Finished task 0.0 in stage 1.0 (TID 1). 1614 bytes result sent to driver
22/03/02 07:47:21 INFO CoarseGrainedExecutorBackend: Got assigned task 2
22/03/02 07:47:21 INFO Executor: Running task 0.0 in stage 2.0 (TID 2)
22/03/02 07:47:21 INFO TorrentBroadcast: Started reading broadcast variable 5 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_5_piece0 stored as bytes in memory (estimated size 5.4 KiB, free 433.9 MiB)
22/03/02 07:47:21 INFO TorrentBroadcast: Reading broadcast variable 5 took 11 ms
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_5 stored as values in memory (estimated size 10.8 KiB, free 433.9 MiB)
22/03/02 07:47:21 INFO FileScanRDD: Reading File path: file:///workspace/PysparkMongoAirflow/Final_Project/data/source/transactions/2021-11-01/part-00000-8f0661ad-96d1-41c9-9b42-0d887254a35f-c000.csv, range: 0-251273, partition values: [empty row]
22/03/02 07:47:21 INFO TorrentBroadcast: Started reading broadcast variable 4 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 24.1 KiB, free 433.9 MiB)
22/03/02 07:47:21 INFO TorrentBroadcast: Reading broadcast variable 4 took 11 ms
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 201.2 KiB, free 433.7 MiB)
22/03/02 07:47:21 INFO Executor: Finished task 0.0 in stage 2.0 (TID 2). 1577 bytes result sent to driver
22/03/02 07:47:21 INFO CoarseGrainedExecutorBackend: Got assigned task 3
22/03/02 07:47:21 INFO Executor: Running task 0.0 in stage 3.0 (TID 3)
22/03/02 07:47:21 INFO TorrentBroadcast: Started reading broadcast variable 7 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 7.9 KiB, free 433.7 MiB)
22/03/02 07:47:21 INFO TorrentBroadcast: Reading broadcast variable 7 took 11 ms
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 15.6 KiB, free 433.7 MiB)
22/03/02 07:47:21 INFO FileScanRDD: Reading File path: file:///workspace/PysparkMongoAirflow/Final_Project/data/source/transactions/2021-11-01/part-00000-8f0661ad-96d1-41c9-9b42-0d887254a35f-c000.csv, range: 0-251273, partition values: [empty row]
22/03/02 07:47:21 INFO TorrentBroadcast: Started reading broadcast variable 6 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 24.1 KiB, free 433.6 MiB)
22/03/02 07:47:21 INFO TorrentBroadcast: Reading broadcast variable 6 took 27 ms
22/03/02 07:47:21 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 201.2 KiB, free 433.4 MiB)
22/03/02 07:47:21 INFO Executor: Finished task 0.0 in stage 3.0 (TID 3). 1629 bytes result sent to driver
22/03/02 07:47:22 INFO CoarseGrainedExecutorBackend: Got assigned task 4
22/03/02 07:47:22 INFO Executor: Running task 0.0 in stage 4.0 (TID 4)
22/03/02 07:47:22 INFO TorrentBroadcast: Started reading broadcast variable 9 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_9_piece0 stored as bytes in memory (estimated size 5.4 KiB, free 433.5 MiB)
22/03/02 07:47:22 INFO TorrentBroadcast: Reading broadcast variable 9 took 25 ms
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_9 stored as values in memory (estimated size 10.8 KiB, free 433.4 MiB)
22/03/02 07:47:22 INFO FileScanRDD: Reading File path: file:///workspace/PysparkMongoAirflow/Final_Project/data/source/users/2021-11-01/part-00000-90950e0e-e0ae-4b04-a8ba-e2e6d8420f9e-c000.csv, range: 0-19126, partition values: [empty row]
22/03/02 07:47:22 INFO TorrentBroadcast: Started reading broadcast variable 8 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_8_piece0 stored as bytes in memory (estimated size 24.1 KiB, free 433.9 MiB)
22/03/02 07:47:22 INFO TorrentBroadcast: Reading broadcast variable 8 took 14 ms
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_8 stored as values in memory (estimated size 201.2 KiB, free 433.9 MiB)
22/03/02 07:47:22 INFO Executor: Finished task 0.0 in stage 4.0 (TID 4). 1563 bytes result sent to driver
22/03/02 07:47:22 INFO CoarseGrainedExecutorBackend: Got assigned task 5
22/03/02 07:47:22 INFO Executor: Running task 0.0 in stage 5.0 (TID 5)
22/03/02 07:47:22 INFO TorrentBroadcast: Started reading broadcast variable 11 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_11_piece0 stored as bytes in memory (estimated size 7.9 KiB, free 434.2 MiB)
22/03/02 07:47:22 INFO TorrentBroadcast: Reading broadcast variable 11 took 9 ms
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_11 stored as values in memory (estimated size 15.5 KiB, free 434.1 MiB)
22/03/02 07:47:22 INFO FileScanRDD: Reading File path: file:///workspace/PysparkMongoAirflow/Final_Project/data/source/users/2021-11-01/part-00000-90950e0e-e0ae-4b04-a8ba-e2e6d8420f9e-c000.csv, range: 0-19126, partition values: [empty row]
22/03/02 07:47:22 INFO TorrentBroadcast: Started reading broadcast variable 10 with 1 pieces (estimated total size 4.0 MiB)
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_10_piece0 stored as bytes in memory (estimated size 24.1 KiB, free 434.1 MiB)
22/03/02 07:47:22 INFO TorrentBroadcast: Reading broadcast variable 10 took 11 ms
22/03/02 07:47:22 INFO MemoryStore: Block broadcast_10 stored as values in memory (estimated size 201.2 KiB, free 433.9 MiB)
22/03/02 07:47:22 INFO Executor: Finished task 0.0 in stage 5.0 (TID 5). 1571 bytes result sent to driver
22/03/02 07:47:22 INFO CoarseGrainedExecutorBackend: Driver commanded a shutdown
22/03/02 07:47:22 ERROR CoarseGrainedExecutorBackend: RECEIVED SIGNAL TERM
tdown
